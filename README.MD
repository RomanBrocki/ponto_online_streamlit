# ğŸ•’ Ponto Online Residencial

Um aplicativo simples de ponto eletrÃ´nico para uso residencial, feito com [Streamlit](https://streamlit.io/) e [Supabase](https://supabase.com/). O objetivo Ã© permitir que uma empregada domÃ©stica registre seus horÃ¡rios de forma segura e que os administradores acompanhem as jornadas e gerem relatÃ³rios mensais.

---

## ğŸŒŸ Funcionalidades

### Para a empregada

* Registro de ponto do **dia atual**:

  * ğŸŸ¢ Entrada
  * ğŸ½ï¸ SaÃ­da para almoÃ§o
  * ğŸ”„ Retorno do almoÃ§o
  * ğŸ”´ SaÃ­da final
* SugestÃ£o automÃ¡tica de:

  * HorÃ¡rio de retorno do almoÃ§o (apÃ³s 1h)
  * HorÃ¡rio de saÃ­da final (ajustado pela carga horÃ¡ria e intervalo real de almoÃ§o)
* ExibiÃ§Ã£o do saldo mensal de horas (positivas ou negativas)
* Bloqueio automÃ¡tico apÃ³s jornada completa
* VisualizaÃ§Ã£o das marcaÃ§Ãµes feitas no dia

### Para o administrador

* Consulta de registros por mÃªs e por empregada
* EdiÃ§Ã£o e exclusÃ£o de qualquer marcaÃ§Ã£o
* InclusÃ£o de observaÃ§Ãµes como:

  * Feriado
  * Falta
  * Dispensa Justificada
* GeraÃ§Ã£o de relatÃ³rios mensais em PDF com:

  * Tabela de marcaÃ§Ãµes por dia
  * Saldos diÃ¡rios
  * Resumo de horas extras, faltas e feriados

### LÃ³gicas internas importantes

* Cada empregada pode ter **apenas um registro por data** (evita duplicidade)
* A jornada de trabalho Ã© considerada **completa** quando os quatro campos estÃ£o preenchidos
* O saldo mensal considera:

  * Dias Ãºteis
  * Horas efetivamente registradas
  * ObservaÃ§Ãµes de justificativa ou falta

---

## ğŸ” Login e SeguranÃ§a

### Mecanismo

* O login Ã© feito com:

  * **Login**: identifica o perfil (ex: `rani`, `brocki`)
  * **Senha**: fragmento exclusivo que completa a URL de acesso
* Isso monta dinamicamente:

  * `URL = URL_INICIO + senha + URL_FIM`
  * `KEY = chave opcional gerada com base na senha`

### BenefÃ­cios

* Nenhuma credencial sensÃ­vel Ã© armazenada diretamente no repositÃ³rio
* O projeto pode ser pÃºblico sem comprometer seguranÃ§a

---

## ğŸ—ƒï¸ Estrutura da Base de Dados (Supabase)

A aplicaÃ§Ã£o utiliza uma tabela Ãºnica chamada `ponto_eletronico` hospedada no Supabase. Ela armazena todas as marcaÃ§Ãµes de ponto realizadas pelos usuÃ¡rios com os seguintes campos:

| Campo         | Tipo | DescriÃ§Ã£o                                                            |
| ------------- | ---- | -------------------------------------------------------------------- |
| id            | int  | Chave primÃ¡ria, gerada automaticamente                               |
| empregado     | text | Nome do empregado (ex: "rani")                                       |
| data          | date | Data do ponto (no formato ISO, ex: 2025-07-08)                       |
| entrada       | text | HorÃ¡rio de entrada (ex: "08:00:00")                                  |
| saida\_almoco | text | HorÃ¡rio de saÃ­da para o almoÃ§o                                       |
| volta\_almoco | text | HorÃ¡rio de retorno do almoÃ§o                                         |
| saida\_final  | text | HorÃ¡rio de saÃ­da final do expediente                                 |
| observacao    | text | ComentÃ¡rio opcional: "feriado", "falta", "dispensa justificada" etc. |

### Regras e Garantias

* ğŸ”’ A combinaÃ§Ã£o `empregado + data` deve ser Ãºnica â€” isso Ã© garantido pela lÃ³gica da aplicaÃ§Ã£o
* ğŸ§  O sistema sÃ³ permite um registro por dia por empregado, seja criado pela prÃ³pria empregada ou pelo administrador
* â±ï¸ Os horÃ¡rios sÃ£o registrados sequencialmente e exibidos apÃ³s preenchidos
* ğŸ—“ï¸ O saldo mensal Ã© calculado com base na jornada esperada (`CARGA_HORARIA_PADRAO`) e nas marcaÃ§Ãµes efetivas do mÃªs

---

## ğŸ“… Estrutura do Projeto

```bash
ponto_online/
â”œâ”€â”€ app.py                        # Arquivo principal do Streamlit
â”‚
â”œâ”€â”€ interface/                   # Interface do usuÃ¡rio
â”‚   â”œâ”€â”€ i_vars.py                  # VariÃ¡veis globais (logins, carga horÃ¡ria)
â”‚   â”œâ”€â”€ i_visuais.py               # Estilos visuais (CSS, cabeÃ§alho)
â”‚   â”œâ”€â”€ i_login.py                 # Tela de login
â”‚   â”œâ”€â”€ i_empregada.py             # Tela da empregada (marcaÃ§Ã£o do dia atual)
â”‚   â”œâ”€â”€ i_admin.py                 # Tela administrativa (consulta, ediÃ§Ã£o, PDF)
â”‚   â””â”€â”€ i_helpers.py               # FunÃ§Ãµes auxiliares de data, hora, validaÃ§Ã£o
â”‚
â”œâ”€â”€ supabase/                    # IntegraÃ§Ã£o com Supabase
â”‚   â”œâ”€â”€ s_secrets.py               # Fragmentos da URL/KEY
â”‚   â”œâ”€â”€ s_config.py                # Montagem de URL/KEY
â”‚   â”œâ”€â”€ s_headers.py               # Headers padrÃ£o de acesso
â”‚   â””â”€â”€ s_utils.py                 # FunÃ§Ãµes de leitura, inserÃ§Ã£o, atualizaÃ§Ã£o e exclusÃ£o
â”‚
â”œâ”€â”€ relatorio/                   # LÃ³gicas de anÃ¡lise e geraÃ§Ã£o de PDF
â”‚   â”œâ”€â”€ r_utils.py                 # CÃ¡lculo de saldo mensal e anÃ¡lise por dia
â”‚   â””â”€â”€ r_pdf_generator.py         # GeraÃ§Ã£o de relatÃ³rio mensal em PDF
â”‚
â”œâ”€â”€ assets/                      # Imagens e estilos visuais (ex: fundo do app)
â”œâ”€â”€ requirements.txt             # Lista de dependÃªncias
â””â”€â”€ README.md                    # Este documento
```

---

## ğŸš€ InstalaÃ§Ã£o e ExecuÃ§Ã£o

```bash
# Clone o repositÃ³rio
git clone https://github.com/RomanBrocki/ponto_online_streamlit
cd ponto_online

# Crie e ative a venv
python -m venv .venv
source .venv/bin/activate  # ou .venv\Scripts\activate no Windows

# Instale as dependÃªncias
pip install -r requirements.txt

# Rode o app
streamlit run app.py
```

---

## âœï¸ Autor

* Roman Wladyslaw Brocki Neto

Este projeto foi desenvolvido com o apoio do ChatGPT, utilizado para geraÃ§Ã£o de ideias, revisÃ£o de cÃ³digo e documentaÃ§Ã£o tÃ©cnica.
